(function(){"use strict";angular.module("ppdbApp",["ngCookies","ngResource","ngSanitize","ngRoute","infinite-scroll","ngDropdowns"]).config(["$routeProvider",function(a){return a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/search",{templateUrl:"views/search.html",controller:"SearchCtrl"}).when("/download",{templateUrl:"views/download.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope",function(a){return a.languages=[{value:"ara",text:"Arabic"},{value:"bul",text:"Bulgarian"},{value:"ces",text:"Czech"},{value:"deu",text:"German"},{value:"ell",text:"Modern Greek"},{value:"en",text:"English"},{value:"est",text:"Estonian"},{value:"fin",text:"Finnish"},{value:"fra",text:"French"},{value:"hun",text:"Hungarian"},{value:"ita",text:"Italian"},{value:"lav",text:"Latvian"},{value:"lit",text:"Lithuanian"},{value:"nld",text:"Dutch"},{value:"pol",text:"Polish"},{value:"por",text:"Portuguese"},{value:"ron",text:"Romanian"},{value:"rus",text:"Russian"},{value:"slk",text:"Slovak"},{value:"slv",text:"Slovene"},{value:"spa",text:"Spanish"}],a.defaultSelectedLanguage={value:"en",text:"English"},a.searchableLanguages=a.languages.filter(function(a){var b;return"Arabic"===(b=a.text)||"English"===b||"Polish"===b||"German"===b||"Italian"===b})}])}).call(this),function(){"use strict";var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("ppdbApp").service("Search",["$http","$rootScope","$interpolate","Cookie",function(b,c,d,e){var f;return new(f=function(){function c(){this.searchQuery="",this.searchLanguage="en",this.resetSearch()}var f;return c.prototype.SEARCH_URL_TEMPLATE=d("/api/{{ languageCode }}/search/"),c.prototype.setSearchQueryAndLanguage=function(a,b){return this.searchQuery=a,this.searchLanguage=b},c.prototype.resetResults=function(){return this.currentBatchNumber=0,this.allRecordsCount=0,this.recordNumber=1,this.busy=!1,this.hasMoreRecords=!0,this.records=[]},c.prototype.resetSearch=function(){return this.gotPOSList=!1,this.partsOfSpeech=[],this.resetResults()},c.prototype.updateFilters=function(){var a,b,c,d,e;for(d=this.partsOfSpeech,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.displayed=a.checked);return e},c.prototype.getCheckedFilters=function(){var a,b,c,d,e,f;for(a=function(){var a,b,d,e;for(d=this.partsOfSpeech,e=[],a=0,b=d.length;b>a;a++)c=d[a],c.checked&&e.push(c);return e}.call(this),f=[],d=0,e=a.length;e>d;d++)b=a[d],f.push(b.lhs);return f},f=function(a){return""+a.source+"|"+a.lhs+"|"+a.target},c.prototype.fetchResults=function(d){var g,h,i,j;return j=this,this.hasMoreRecords?(g=d||function(){var a,b,c,d;for(c=this.partsOfSpeech,d=[],a=0,b=c.length;b>a;a++)h=c[a],h.displayed&&d.push(h.lhs);return d}.call(this),this.busy=!0,i=c.prototype.SEARCH_URL_TEMPLATE({languageCode:this.searchLanguage}),b.get(i,{params:{q:this.searchQuery,batchNumber:this.currentBatchNumber,needsPOSList:!this.gotPOSList,lhs:g}}).success(function(b){var c,g,h,i,k,l,m,n,o,p;for(n=b.hits.hit,i=0,l=n.length;l>i;i++)c=n[i],c.recordNumber=j.recordNumber,c.canChangeScoreDown=!e.hasKeyandPositiveValue(""+f(c)+"down"),c.canCancelScoreDown=!1,c.canChangeScoreUp=!e.hasKeyandPositiveValue(""+f(c)+"up"),c.canCancelScoreUp=!1,c.firstappearsin=Math.floor(c.firstappearsin),j.records.push(c),j.recordNumber+=1;if(!j.gotPOSList&&(g=!0,null!=b.parts_of_speech))for(o=b.parts_of_speech,k=0,m=o.length;m>k;k++)h=o[k],null!=d?h.checked=(p=h.lhs,a.call(d,p)>=0):h.checked=g,h.displayed=h.checked,g=!1,j.partsOfSpeech.push(h);return j.gotPOSList=!0,j.allRecordsCount=b.hits.found,j.allRecordsCount===j.records.length&&(j.hasMoreRecords=!1),j.currentBatchNumber+=1})["finally"](function(){return j.busy=!1})):void 0},c}())}])}.call(this),function(){"use strict";angular.module("ppdbApp").controller("SearchCtrl",["$scope","$http","$location","$route","$rootScope","$window","Search","Title",function(a,b,c,d,e,f,g,h){return a.shouldDownloadBeShown=!0,a.sizes={1:"S",2:"M",3:"L",4:"XL",5:"XXL",6:"XXXL",7:"4XL"},a.onlyFiltersChanged=!1,a.loading=!1,a.searchUrl="/api/search/",a.models={searchQuery:""},a.lastRoute=d.current,a.checkedLanguage=angular.copy(e.defaultSelectedLanguage),a.searchService=g,a.getFiltersFromLocation=function(){var a;return a=c.search().filter,a?a.split(","):null},a.changeFiltersInBar=function(){return a.onlyFiltersChanged=!0,a.lastRoute=d.current,c.search("filter",a.searchService.getCheckedFilters().toString())},a.getLanguageOrDeafult=function(b){var c;return c=a.languages.filter(function(a){return a.value===b}),c.length?angular.copy(c[0]):angular.copy(e.defaultSelectedLanguage)},a.getLanguageFromURL=function(){return a.checkedLanguage=a.getLanguageOrDeafult(c.search().lang),a.models.selectedLanguage=a.checkedLanguage.value},a.$on("$locationChangeSuccess",function(b){return a.onlyFiltersChanged?(b.preventDefault(),d.current=a.lastRoute,a.onlyFiltersChanged=!1):(h.setTitle(c.search().q),a.models.searchQuery=c.search().q,a.getLanguageFromURL(),a.searchService.busy?void 0:(a.searchService.resetSearch(),a.searchService.setSearchQueryAndLanguage(a.models.searchQuery,a.models.selectedLanguage),a.searchService.fetchResults(a.getFiltersFromLocation())))}),a.clearInput=function(){return a.models.searchQuery=""},a.search=function(b){return null==b&&(b=null),b?(a.models.searchQuery=b,a.checkedLanguage=a.getLanguageOrDeafult(a.models.selectedLanguage)):a.models.selectedLanguage=a.checkedLanguage.value,c.search({q:a.models.searchQuery,filter:"",lang:a.models.selectedLanguage}),a.searchService.resetSearch(),a.searchService.setSearchQueryAndLanguage(a.models.searchQuery,a.models.selectedLanguage),f.google_analytics_track(a.models.searchQuery),a.searchService.fetchResults()},a.changeFilters=function(){return a.changeFiltersInBar(),a.searchService.resetResults(),a.searchService.updateFilters(),a.searchService.fetchResults()},a.models.searchQuery=c.search().q,h.setTitle(a.models.searchQuery),a.getLanguageFromURL(),a.searchService.busy?void 0:(a.searchService.resetSearch(),a.searchService.setSearchQueryAndLanguage(a.models.searchQuery,a.models.selectedLanguage),a.searchService.fetchResults(a.getFiltersFromLocation()))}])}.call(this),function(){"use strict";angular.module("ppdbApp").controller("VoteCtrl",["$scope","$http","Cookie","Search",function(a,b,c,d){var e,f,g,h;return f="/api/"+d.searchLanguage+"/update_score/",h="vote",e="cancel",g=function(a){return""+a.source+"|"+a.lhs+"|"+a.target},a.updateScore=function(a,d,i){return a["canChangeScore"+("up"===d?"Up":"Down")]=!1,a["canCancelScore"+("up"===d?"Up":"Down")]=!1,b.post(f,{pk:a.id,action_type:d,action_mode:i===h?"increment":"decrement"}).success(function(b){var f,j,k;return f=i===e,a["canChangeScore"+("up"===d?"Up":"Down")]=f,a["canCancelScore"+("up"===d?"Up":"Down")]=!f,k="up"===d?"score_up":"score_down",j=i===h?1:-1,a[k]=j+a[k],c.setKey(""+g(a)+d,i)}).error(function(b){return a["canChangeScore"+("up"===d?"Up":"Down")]=!0,a["canCancelScore"+("up"===d?"Up":"Down")]=!1})},a.scoreDown=function(b){return a.updateScore(b,"down",h)},a.cancelScoreDown=function(b){return a.updateScore(b,"down",e)},a.scoreUp=function(b){return a.updateScore(b,"up",h)},a.cancelScoreUp=function(b){return a.updateScore(b,"up",e)}}])}.call(this),function(){"use strict";angular.module("ppdbApp").controller("MainCtrl",["$scope","$routeParams","$location","$window","Title",function(a,b,c,d,e){return e.setEmptyTitle(),a.checkedLanguage=angular.copy(a.defaultSelectedLanguage),a.models={searchQuery:""},a.search=function(){return c.search({q:a.models.searchQuery,filter:"",lang:a.checkedLanguage.value}),d.google_analytics_track(a.models.searchQuery),c.path("/search")}}])}.call(this),UserVoice=window.UserVoice||[],function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="//widget.uservoice.com/aHBApAiaEbMDXS1YKIoYAg.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}(),UserVoice.push(["set",{accent_color:"#6aba2e",trigger_color:"white",trigger_background_color:"#6aba2e"}]),UserVoice.push(["identify",{}]),UserVoice.push(["addTrigger",{mode:"smartvote",trigger_position:"bottom-right"}]),UserVoice.push(["autoprompt",{}]);var dd=angular.module("ngDropdowns",[]);dd.directive("dropdownSelect",["DropdownService","$window",function(a,b){return{restrict:"A",replace:!0,scope:{dropdownSelect:"=",dropdownModel:"=",dropdownOnchange:"&"},controller:["$scope","$element","$attrs",function(b,c,d){b.labelField=d.dropdownItemLabel||"text",a.register(c),this.select=function(a){a!==b.dropdownModel&&angular.copy(a,b.dropdownModel),b.dropdownOnchange({selected:a})};var e="click";c.bind(e,function(b){b.stopPropagation(),a.toggleActive(c)}),b.$on("$destroy",function(){a.unregister(c)})}],template:['<div class="wrap-dd-select">','<span class="selected">{{dropdownModel[labelField]}}</span>','<ul class="dropdown">','<li ng-repeat="item in dropdownSelect"',' class="dropdown-item"',' dropdown-select-item="item"',' dropdown-item-label="labelField">',"</li>","</ul>","</div>"].join("")}}]),dd.directive("dropdownSelectItem",[function(){return{require:"^dropdownSelect",replace:!0,scope:{dropdownItemLabel:"=",dropdownSelectItem:"="},link:function(a,b,c,d){a.selectItem=function(){a.dropdownSelectItem.href||d.select(a.dropdownSelectItem)}},template:['<li ng-class="{divider: dropdownSelectItem.divider}">','<a href="" class="dropdown-item"',' ng-if="!dropdownSelectItem.divider"',' ng-href="{{dropdownSelectItem.href}}"',' title="{{dropdownSelectItem[dropdownItemLabel]}}"',' ng-click="selectItem()">',"{{dropdownSelectItem[dropdownItemLabel]}}","</a>","</li>"].join("")}}]),dd.directive("dropdownMenu",["$parse","$compile","DropdownService","$window",function(a,b,c,d){return{restrict:"A",replace:!1,scope:{dropdownMenu:"=",dropdownModel:"=",dropdownOnchange:"&"},controller:["$scope","$element","$attrs",function(a,e,f){a.labelField=f.dropdownItemLabel||"text";var g="ontouchstart"in d?"touchend":"click",h=angular.element(['<ul class="dropdown">','<li ng-repeat="item in dropdownMenu"',' class="dropdown-item"',' dropdown-item-label="labelField"',' dropdown-menu-item="item">',"</li>","</ul>"].join(""));h.data("$dropdownMenuController",this);var i=b(h)(a),j=angular.element('<div class="wrap-dd-menu"></div>');e.replaceWith(j),j.append(e),j.append(i),c.register(i),this.select=function(b){b!==a.dropdownModel&&angular.copy(b,a.dropdownModel),a.dropdownOnchange({selected:b})},e.bind(g,function(a){a.stopPropagation(),c.toggleActive(i)}),a.$on("$destroy",function(){c.unregister(i)})}]}}]),dd.directive("dropdownMenuItem",[function(){return{require:"^dropdownMenu",replace:!0,scope:{dropdownMenuItem:"=",dropdownItemLabel:"="},link:function(a,b,c,d){a.selectItem=function(){a.dropdownMenuItem.href||d.select(a.dropdownMenuItem)}},template:['<li ng-class="{divider: dropdownMenuItem.divider}">','<a href="" class="dropdown-item"',' ng-if="!dropdownMenuItem.divider"',' ng-href="{{dropdownMenuItem.href}}"',' ng-click="selectItem()">',"{{dropdownMenuItem[dropdownItemLabel]}}","</a>","</li>"].join("")}}]),dd.factory("DropdownService",["$document",function(a){var b=a.find("body"),c={},d=[];return b.bind("click",function(){angular.forEach(d,function(a){a.removeClass("active")})}),c.register=function(a){d.push(a)},c.unregister=function(a){var b;b=d.indexOf(a),b>-1&&d.splice(b,1)},c.toggleActive=function(a){angular.forEach(d,function(b){b!==a&&b.removeClass("active")}),a.toggleClass("active")},c}]),function(){"use strict";angular.module("ppdbApp").service("Cookie",function(){var a;return new(a=function(){function a(){}return a.prototype.hasKeyandPositiveValue=function(a){var b,c,d,e,f,g,h,i;for(h=document.cookie.split(";"),d=0,f=h.length;f>d;d++)if(b=h[d],b.substring(1,a.length+1)===a)for(i=b.split("="),e=0,g=i.length;g>e;e++)if(c=i[e],"vote"===c)return!0;return!1},a.prototype.setKey=function(a,b){return document.cookie=""+a+"="+b},a}())})}.call(this),function(){"use strict";angular.module("ppdbApp").controller("DownloadCtrl",["$scope","$rootScope",function(a,b){var c,d,e;return a.shouldDownloadBeShown=!1,a.actualLanguage=angular.copy(b.defaultSelectedLanguage.value),a.downloadLanguages=angular.copy(b.languages),a.showAdditionalOptions=!1,a.allOptions={all:{name:"All"},lexical:{name:"Lexical",subsets:[{name:"Paraphrases",code:"lexical"},{name:"Identity",code:"lexical-self",nonEnglishCode:"lexical-identity"}]},oneToMany:{name:"One-To-Many",subsets:[{name:"One-To-Many",code:"o2m"},{name:"Many-To-One",code:"m2o"}]},phrasal:{name:"Phrasal",subsets:[{name:"Paraphrases",code:"phrasal"},{name:"Identity",code:"phrasal-self",nonEnglishCode:"phrasal-identity"}]},syntatic:{name:"Syntatic",subsets:[{name:"Consitutent",code:"ccg"},{name:"Non-Constituent",code:"noccg"}]}},a.englishOptions=angular.copy(a.allOptions),delete a.englishOptions.oneToMany,a.englishOptions.syntax=a.englishOptions.syntatic,delete a.englishOptions.syntatic,a.optionsSubsets=null,a.getOptions=function(){return"en"===a.actualLanguage?a.englishOptions:a.allOptions},a.fileSizes=["s","m","l","xl","xxl","xxxl"],a.selectedOption=null,a.selectedOptionSubset=null,a.changeLanguage=function(b){return a.actualLanguage=b,a.selectedOption&&!a.getOptions()[a.selectedOption]?a.selectedOption=null:void 0},a.changeOption=function(b){var c;return c=a.getOptions(),"all"!==b&&"en"!==a.actualLanguage?(a.optionsSubsets=c[b].subsets,a.selectedOptionSubset=c[b].subsets[0]):a.optionsSubsets=null,a.selectedOption=b},a.getOptionsSubsets=function(){var b;return b=a.selectedOption||"all","all"!==a.selectedOption&&"en"!==a.actualLanguage?a.getOptions()[a.selectedOption].subsets:null},a.changeOptionSubset=function(b){return a.selectedOptionSubset=b},e=function(){return a.selectedOptionSubset?a.selectedOptionSubset.code:"all"},d=function(b){var c,d;return c=a.selectedOptionSubset?null!=a.selectedOptionSubset.nonEnglishCode?a.selectedOptionSubset.nonEnglishCode:a.selectedOptionSubset.code:"all",d="lexical-identity"!==c&&"phrasal-identity"!==c||"xxxl"!==b?b:"all",""+d+"-"+c},c=function(b){var c,e;return"en"===a.actualLanguage?(c=a.selectedOption||"all","http://nlpgrid.seas.upenn.edu/PPDB/eng/ppdb-2.0-"+b+"-"+c+".gz"):(e=d(b),"http://nlpgrid.seas.upenn.edu/PPDB/"+a.actualLanguage+"/ppdb-1.0-"+e+".gz")},a.downloadFile=function(a){return window.location.href=c(a)}}])}.call(this),function(){"use strict";angular.module("ppdbApp").service("Title",function(){this.titleSuffix="PPDB",this.title="",this.getTitle=function(){return""===this.title?this.titleSuffix:""+this.title+" - "+this.titleSuffix},this.setTitle=function(a){return this.title=a},this.setEmptyTitle=function(){return this.title=""}})}.call(this),function(){"use strict";angular.module("ppdbApp").controller("TitleCtrl",["$scope","Title",function(a,b){return a.titleService=b}])}.call(this);